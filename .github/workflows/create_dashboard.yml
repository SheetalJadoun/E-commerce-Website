name: Create Datadog Dashboard

on:
  push:
    branches:
      - main

jobs:
  create_dashboard:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Create dashboard
        # run: | 
        #   curl -X GET "https://api.datadoghq.com/api/v1/validate" \
        #     -H "Accept: application/json" \
        #     -H "DD-API-KEY: fc13f5c19c965e763ee4418b6124d6ec" \
        #     -H "DD-APPLICATION-KEY: e81cab11be284f939be622b26cb6be6567206136" \
        run: |
          curl -X POST \
            -H "Content-Type: application/json" \
            -H "DD-API-KEY: fc13f5c19c965e763ee4418b6124d6ec" \
            -H "DD-APPLICATION-KEY: e81cab11be284f939be622b26cb6be6567206136" \
            -d @dashboard.json \
            "https://api.datadoghq.com/api/v1/dashboard?api_key=${{ secrets.DD_API_KEY }}&application_key=${{ secrets.DD_APP_KEY }}"